---
- hosts: localhost
  connection: local
  sudo: yes
  vars:
      internal_ip: "{{ INTERNAL_IP }}"
      consul_endpoint: "{{ CONSUL_ENDPOINT }}"
  roles:
      - {role: "/root/ansible/ansible-consul",
         consul_version: 0.6.3,
         consul_is_server: true,
         consul_bootstrap: true,
         consul_bind_address: "{{ internal_ip }}",
         consul_client_address: "{{ internal_ip }}",
         consul_client_address_bind: true}
      - {role: "/root/ansible/docker",
         docker_opts: "--cluster-store=consul://{{ consul_endpoint }}:8500 --cluster-advertise={{ internal_ip }}:2375 -H tcp://{{ internal_ip  }}:2375 -H unix:///var/run/docker.sock"}
      - {role: "/root/ansible/manager"}
